<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Blokz Reflex</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    /* --- RESET & BASE --- */
    * {
      box-sizing: border-box;
    }
    body, html {
      margin: 0; padding: 0;
      height: 100%;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #111;
      color: #fff;
      overflow-y: auto; /* permettre le scroll */
    }
    h1 {
      margin: 20px 0 10px 0;
      text-align: center;
      text-shadow: 0 0 8px #0af;
    }
    button {
      cursor: pointer;
    }
    /* --- BOUTON PERSONNALISATION FOND --- */
    #btnChangeBg {
      position: fixed;
      top: 15px;
      right: 15px;
      background: #0af;
      border: none;
      padding: 10px 14px;
      border-radius: 8px;
      font-weight: bold;
      z-index: 1000;
      box-shadow: 0 0 6px #0af;
    }
    /* --- CONTAINERS --- */
    #menu, #info, #gameOver, #instructions, #game {
      max-width: 360px;
      margin: 20px auto;
      background: rgba(0,0,0,0.5);
      padding: 15px 20px;
      border-radius: 12px;
    }
    #info {
      display: none;
      text-align: center;
      font-size: 18px;
    }
    #game {
      position: relative;
      height: 400px;
      background: rgba(20,20,30,0.9);
      border-radius: 12px;
      overflow: hidden;
    }
    #gameOver {
      display: none;
      text-align: center;
    }
    #message {
      text-align: center;
      height: 25px;
      margin-top: 10px;
      font-weight: bold;
      color: #0af;
    }
    /* --- BOUTONS --- */
    .button {
      background: #0af;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 12px 18px;
      margin: 10px 5px;
      font-size: 16px;
      transition: background 0.3s;
    }
    .button:hover {
      background: #06c;
    }
    /* --- BLOCKS --- */
    .block {
      width: 60px;
      height: 60px;
      position: absolute;
      border-radius: 10px;
      cursor: pointer;
      transition: transform 0.15s;
      user-select: none;
      background: #333;
    }
    .explosive { background: #e03e3e; }
    .frozen { background: #3ec9e0; }
    .frozen::after {
      content: "‚ùÑ"; position: absolute; top: 5px; right: 5px; font-size: 18px;
    }
    .bomb { background: #ffa500; }
    .bomb::after {
      content: "üí£"; position: absolute; top: 5px; right: 5px; font-size: 18px;
    }
    /* --- INSTRUCTIONS --- */
    #instructions {
      font-size: 14px;
      line-height: 1.4;
      color: #ccc;
      max-width: 360px;
      margin: 10px auto 30px;
      background: rgba(0,0,0,0.6);
      border-radius: 12px;
      padding: 12px 18px;
    }
  </style>
</head>
<body>

<h1>üß± Blokz Reflex</h1>

<button id="btnChangeBg" title="Changer le fond">üé®</button>
<input type="file" id="inputBg" accept="image/*" style="display:none" />

<div id="menu">
  <p>Choisis ton mode :</p>
  <button class="button" onclick="startGame('facile')">Facile</button>
  <button class="button" onclick="startGame('moyen')">Moyen</button>
  <button class="button" onclick="startGame('impossible')">Impossible</button>
</div>

<div id="instructions">
  <h3>Instructions</h3>
  <ul>
    <li>Clique sur les blocs color√©s pour gagner des points.</li>
    <li>Ne clique pas sur les blocs gris (normaux), sinon tu perds une vie.</li>
    <li>Le temps pour cliquer sur les blocs diminue au fur et √† mesure.</li>
    <li>Le mode <strong>Impossible</strong> commence plus facile puis devient vraiment difficile apr√®s 10 points.</li>
    <li>Tu as un nombre limit√© de vies selon le mode choisi.</li>
  </ul>
</div>

<div id="info">
  Score : <span id="score">0</span> | Vies : <span id="lives">2</span>
</div>

<div id="game"></div>

<div id="message"></div>

<div id="gameOver">
  <h2>üíÄ Game Over</h2>
  <p>Veux-tu recommencer ?</p>
  <button class="button" onclick="restartGame()">üîÅ Recommencer</button>
</div>

<audio id="popSound" src="https://freesound.org/data/previews/256/256113_3263906-lq.mp3"></audio>

<script>
  const scoreEl = document.getElementById('score');
  const livesEl = document.getElementById('lives');
  const infoEl = document.getElementById('info');
  const menuEl = document.getElementById('menu');
  const gameEl = document.getElementById('game');
  const gameOverEl = document.getElementById('gameOver');
  const messageEl = document.getElementById('message');
  const popSound = document.getElementById('popSound');

  const btnChangeBg = document.getElementById('btnChangeBg');
  const inputBg = document.getElementById('inputBg');

  let score = 0;
  let lives = 2;
  let maxLives = 2;
  let spawnInterval = null;
  let blockDisappearTime = 700; // ms
  let currentMode = null;

  // Difficult√© et vitesse selon mode
  const modes = {
    facile: { spawnDelay: 1200, maxLives: 2, startDisappear: 1000, minDisappear: 700 },
    moyen: { spawnDelay: 900, maxLives: 1, startDisappear: 900, minDisappear: 500 },
    impossible: { spawnDelay: 1000, maxLives: 1, startDisappear: 700, minDisappear: 200 }
  };

  // Perso fond d'√©cran sauvegard√©
  function loadBackground() {
    const bgData = localStorage.getItem('blokzBackground');
    if(bgData) {
      document.body.style.backgroundImage = `url(${bgData})`;
      document.body.style.backgroundSize = 'cover';
      document.body.style.backgroundPosition = 'center';
    } else {
      document.body.style.backgroundImage = '';
      document.body.style.backgroundColor = '#111';
    }
  }
  loadBackground();

  btnChangeBg.onclick = () => {
    inputBg.click();
  };
  inputBg.onchange = e => {
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = e => {
      localStorage.setItem('blokzBackground', e.target.result);
      loadBackground();
    };
    reader.readAsDataURL(file);
  };

  function startGame(mode) {
    currentMode = mode;
    const m = modes[mode];
    maxLives = m.maxLives;
    lives = maxLives;
    score = 0;
    scoreEl.textContent = score;
    livesEl.textContent = lives;
    infoEl.style.display = 'inline-block';
    menuEl.style.display = 'none';
    gameOverEl.style.display = 'none';
    messageEl.textContent = '';
    gameEl.innerHTML = '';
    blockDisappearTime = m.startDisappear;

    spawnInterval = setInterval(() => {
      if (lives <= 0) {
        gameOver();
        return;
      }
      spawnBlock();
      // Augmente la difficult√© progressivement (impossible mode)
      if (mode === 'impossible') {
        if(score >= 10 && blockDisappearTime > m.minDisappear) {
          blockDisappearTime -= 15; // acc√©l√®re la disparition apr√®s 10 pts
        } else if(score < 10 && blockDisappearTime < m.startDisappear) {
          blockDisappearTime += 10; // ralentit un peu au d√©but (plus facile avant 10)
        }
      } else {
        // autres modes aussi acc√©l√®rent un peu
        if(blockDisappearTime > m.minDisappear) {
          blockDisappearTime -= 2;
        }
      }
    }, m.spawnDelay);
  }

  function spawnBlock() {
    // Cr√©e un bloc al√©atoire (normal, explosif, gel√©, bombe)
    const blockTypes = ['normal', 'explosive', 'frozen', 'bomb'];
    const typeProb = Math.random();

    // Normal (gris) = 50%
    // explosive = 20%
    // frozen = 20%
    // bomb = 10%
    let type = 'normal';
    if (typeProb > 0.5 && typeProb <= 0.7) type = 'explosive';
    else if (typeProb > 0.7 && typeProb <= 0.9) type = 'frozen';
    else if (typeProb > 0.9) type = 'bomb';

    const block = document.createElement('div');
    block.classList.add('block');
    if(type !== 'normal') block.classList.add(type);

    // Position al√©atoire dans le conteneur
    const gameRect = gameEl.getBoundingClientRect();
    const size = 60;
    const maxX = gameRect.width - size;
    const maxY = gameRect.height - size;
    const x = Math.random() * maxX;
    const y = Math.random() * maxY;

    block.style.left = x + 'px';
    block.style.top = y + 'px';

    gameEl.appendChild(block);

    // Disparition automatique
    const disappearTimeout = setTimeout(() => {
      if(gameEl.contains(block)) {
        gameEl.removeChild(block);
        loseLife();
      }
    }, blockDisappearTime);

    block.onclick = () => {
      popSound.currentTime = 0;
      popSound.play();
      clearTimeout(disappearTimeout);
      if(type === 'normal') {
        // Perdre vie si clique sur normal
        loseLife();
        messageEl.textContent = "Mauvais bloc ! -1 vie";
      } else {
        // Gagner points selon type
        if(type === 'explosive') score += 3;
        else if(type === 'frozen') score += 2;
        else if(type === 'bomb') score += 5;
        else score += 1;

        scoreEl.textContent = score;
        messageEl.textContent = "Bien jou√© ! + points";

        block.style.transform = 'scale(0)';
        setTimeout(() => {
          if(gameEl.contains(block)) gameEl.removeChild(block);
        }, 150);
      }

      // Stop si game over
      if(lives <= 0) gameOver();
    };
  }

  function loseLife() {
    lives--;
    livesEl.textContent = lives;
    if(lives <= 0) {
      gameOver();
    }
  }

  function gameOver() {
    clearInterval(spawnInterval);
    infoEl.style.display = 'none';
    gameOverEl.style.display = 'block';
    messageEl.textContent = '';
  }

  function restartGame() {
    gameOverEl.style.display = 'none';
    menuEl.style.display = 'block';
    gameEl.innerHTML = '';
    messageEl.textContent = '';
  }

</script>

</body>
</html>

   




