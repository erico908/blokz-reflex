<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Blokz Reflex</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-size: cover;
      background-position: center;
      color: #fff;
      text-align: center;
      margin: 0;
      padding: 0;
    }

    h1 {
      margin-top: 20px;
    }

    #menu, #game, #gameOver, #trophies, #shop {
      margin-top: 20px;
    }

    .button {
      padding: 10px 20px;
      margin: 10px;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }

    #game {
      display: none;
      flex-wrap: wrap;
      justify-content: center;
      gap: 8px;
      margin: 20px;
      position: relative;
      height: 60vh;
    }

    .block {
      width: 20vw;
      max-width: 60px;
      aspect-ratio: 1/1;
      background: #333;
      border-radius: 8px;
      cursor: pointer;
      position: absolute;
    }

    .special1 { background: #e03e3e; }
    .special2 { background: #3ec9e0; }
    .special3 { background: #ffa500; }

    #info {
      margin-top: 10px;
      font-size: 18px;
      display: none;
      padding: 8px 16px;
    }

    #gameOver, #trophies, #shop {
      display: none;
    }

    #instructions {
      max-width: 600px;
      margin: auto;
      padding: 20px;
    }

    #image-demo {
      width: 90%;
      max-width: 300px;
      margin: 10px auto;
    }

    #bgPicker {
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 2;
    }
  </style>
</head>
<body>

<h1>üß± Blokz Reflex</h1>

<input type="file" id="bgPicker" accept="image/*" onchange="changeBackground(event)" title="Choisir un fond personnalis√©">

<div id="menu">
  <div id="instructions">
    <p>üìã Clique sur les blocs sp√©ciaux avant qu‚Äôils disparaissent pour gagner des troph√©es üèÜ.</p>
    <p>üí• Clique sur un mauvais bloc = rien ! Ignore un bon bloc = perte de vie !</p>
    <p>üõçÔ∏è Utilise tes troph√©es dans la boutique pour acheter des vies et des bonus.</p>
    <img id="image-demo" src="https://upload.wikimedia.org/wikipedia/en/6/6f/Candy_Crush_icon.png" alt="D√©mo">
  </div>
  <p>Choisis ton mode :</p>
  <button class="button" onclick="startGame('facile')">Facile</button>
  <button class="button" onclick="startGame('moyen')">Moyen</button>
  <button class="button" onclick="startGame('impossible')">Impossible</button>
</div>

<div id="info">
  Score : <span id="score">0</span> | Vies : <span id="lives">2</span> | üèÜ : <span id="trophies">0</span>
</div>

<div id="game"></div>

<div id="gameOver">
  <p id="finalScore"></p>
  <button class="button" onclick="retry()">Recommencer</button>
  <button class="button" onclick="goToMenu()">Retour au menu</button>
</div>

<div id="shop">
  <h2>üõçÔ∏è Boutique</h2>
  <p>Achetez des bonus avec vos troph√©es</p>
  <button class="button" onclick="buyLife()">+1 vie (100 üèÜ)</button>
  <button class="button" onclick="buyBlock('special1', 200)">Bloc rouge (200 üèÜ)</button>
  <button class="button" onclick="buyBlock('special2', 500)">Bloc bleu ‚ùÑ (500 üèÜ)</button>
  <button class="button" onclick="buyBlock('special3', 1000)">Bloc orange üí£ (1000 üèÜ)</button>
</div>

<audio id="popSound" src="https://freesound.org/data/previews/256/256113_3263906-lq.mp3"></audio>

<script>
let score = 0;
let lives = 2;
let trophies = localStorage.getItem("trophies") ? parseInt(localStorage.getItem("trophies")) : 0;
let currentMode = "";
let blockDuration = 2000;
let spawnRate = 1500;
let gameInterval;

function changeBackground(e) {
  const file = e.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = () => document.body.style.backgroundImage = `url('${reader.result}')`;
  reader.readAsDataURL(file);
}

function startGame(mode) {
  currentMode = mode;
  score = 0;
  lives = mode === "facile" ? 2 : 1;
  document.getElementById("menu").style.display = "none";
  document.getElementById("instructions").style.display = "none";
  document.getElementById("info").style.display = "inline-block";
  document.getElementById("game").style.display = "flex";
  document.getElementById("score").textContent = score;
  document.getElementById("lives").textContent = lives;
  document.getElementById("trophies").textContent = trophies;

  if (mode === "facile") {
    blockDuration = 5000;
    spawnRate = 2000;
  } else if (mode === "moyen") {
    blockDuration = 3000;
    spawnRate = 1000;
  } else {
    blockDuration = 700;
    spawnRate = 1000;
  }
  gameInterval = setInterval(spawnBlock, spawnRate);
}

function spawnBlock() {
  const game = document.getElementById("game");
  const block = document.createElement("div");
  block.className = "block";
  block.style.left = `${Math.random() * 80}vw`;
  block.style.top = `${Math.random() * 50}vh`;
  const special = Math.random();
  if (special < 0.5) block.classList.add("special1");

  let clicked = false;
  block.onclick = () => {
    if (!clicked) {
      clicked = true;
      if (block.classList.contains("special1")) {
        score++;
        trophies++;
        localStorage.setItem("trophies", trophies);
        document.getElementById("score").textContent = score;
        document.getElementById("trophies").textContent = trophies;
        document.getElementById("popSound").play();
      }
      block.remove();
    }
  };
  game.appendChild(block);

  setTimeout(() => {
    if (!clicked && block.classList.contains("special1")) {
      lives--;
      document.getElementById("lives").textContent = lives;
      if (lives <= 0) endGame();
    }
    block.remove();
  }, blockDuration);
}

function endGame() {
  clearInterval(gameInterval);
  document.getElementById("game").style.display = "none";
  document.getElementById("info").style.display = "none";
  document.getElementById("gameOver").style.display = "block";
  document.getElementById("finalScore").textContent = `Partie termin√©e ! Score : ${score}`;
}

function retry() {
  document.getElementById("gameOver").style.display = "none";
  startGame(currentMode);
}

function goToMenu() {
  document.getElementById("gameOver").style.display = "none";
  document.getElementById("menu").style.display = "block";
}

function buyLife() {
  if (trophies >= 100) {
    trophies -= 100;
    lives++;
    localStorage.setItem("trophies", trophies);
    document.getElementById("trophies").textContent = trophies;
    document.getElementById("lives").textContent = lives;
  }
}

function buyBlock(type, cost) {
  if (trophies >= cost) {
    trophies -= cost;
    localStorage.setItem("trophies", trophies);
    document.getElementById("trophies").textContent = trophies;
    alert(`${type} d√©bloqu√© ! (non encore activ√©)`);
  }
}
</script>
</body>
</html>

   




