<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Blokz Reflex - Local Multiplayer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
    body { background: linear-gradient(to bottom right, #1f1f1f, #000); color: white; overflow: hidden; }
    
    #localGame {
      display: flex;
      height: 90vh;
      width: 100vw;
      justify-content: center;
      align-items: center;
      gap: 20px;
      padding: 10px;
    }

    #player1Area, #player2Area {
      flex: 1;
      border: 2px solid #00ffc8;
      border-radius: 15px;
      position: relative;
      overflow: hidden;
      height: 80vh;
      max-width: 480px;
      display: flex;
      flex-direction: column;
      align-items: center;
      background: #111;
    }

    #player1Area {
      border-right: 4px solid #00ffc8;
    }

    #player2Area {
      border-left: 4px solid #00ffc8;
    }

    #gameArea1, #gameArea2 {
      flex: 1;
      width: 100%;
      position: relative;
      background: #222;
      border-radius: 12px;
      margin: 15px 0;
    }

    .block {
      position: absolute;
      border-radius: 10px;
      cursor: pointer;
      user-select: none;
      touch-action: manipulation;
    }

    .gray { background: gray; }
    .red { background: #ff4d4d; }
    .blue { background: #4d94ff; }
    .green { background: #4dff88; }
    .yellow { background: #ffff4d; }

    h2 {
      color: #00ffc8;
      margin-top: 15px;
      user-select: none;
    }

    #quitBtn {
      position: absolute;
      top: 10px;
      right: 10px;
      background: #00ffc8;
      border: none;
      border-radius: 10px;
      padding: 10px 15px;
      font-size: 1.1rem;
      cursor: pointer;
      user-select: none;
      z-index: 10;
    }
    #quitBtn:hover {
      background: #00ccaa;
    }

    /* Responsive mobile patch */
    @media (max-width: 600px) {
      #localGame {
        flex-direction: column;
        height: auto;
        padding: 10px 5px;
      }
      #player1Area, #player2Area {
        flex: none;
        height: 45vh;
        max-width: none;
        border-right: none !important;
        border-bottom: 2px solid #00ffc8;
      }
      #player2Area {
        border-bottom: none;
      }
      #gameArea1, #gameArea2 {
        margin: 10px;
      }
      .block {
        width: 70px !important;
        height: 70px !important;
      }
      #quitBtn {
        top: auto;
        bottom: 10px;
        right: 10px;
      }
      #quitBtn {
        font-size: 1.4rem;
        padding: 15px 25px;
      }
    }
  </style>
</head>
<body>
  <div id="localGame">
    <div id="player1Area">
      <h2>Joueur 1</h2>
      <div id="gameArea1"></div>
    </div>
    <div id="player2Area">
      <h2>Joueur 2</h2>
      <div id="gameArea2"></div>
    </div>
    <button id="quitBtn">Quitter</button>
  </div>

  <script>
    const colors = ['red', 'blue', 'green', 'yellow'];
    let gameTimers = [null, null];
    let scores = [0, 0];
    let lives = [3, 3];
    let currentBlocks = [null, null];
    const blockSizeDesktop = 50;
    const blockSizeMobile = 70;
    
    // Choix taille bloc selon √©cran
    function getBlockSize() {
      return window.innerWidth <= 600 ? blockSizeMobile : blockSizeDesktop;
    }
    
    function createBlock(playerIndex) {
      const gameArea = document.getElementById(`gameArea${playerIndex + 1}`);
      gameArea.innerHTML = '';
      const block = document.createElement('div');
      
      const isGray = Math.random() < 0.2;
      block.className = 'block ' + (isGray ? 'gray' : colors[Math.floor(Math.random() * colors.length)]);
      
      const size = getBlockSize();
      block.style.width = size + 'px';
      block.style.height = size + 'px';
      
      block.style.top = Math.random() * (gameArea.clientHeight - size) + 'px';
      block.style.left = Math.random() * (gameArea.clientWidth - size) + 'px';

      block.onclick = () => {
        if (isGray) {
          alert(`Joueur ${playerIndex + 1} a cliqu√© un bloc gris !`);
          endGame(playerIndex, 'perdu toutes ses vies (bloc gris) !');
          return;
        }
        scores[playerIndex]++;
        updateUI();
        clearTimeout(gameTimers[playerIndex]);
        spawnBlock(playerIndex);
      };

      gameArea.appendChild(block);
      currentBlocks[playerIndex] = { element: block, isGray };
    }

    function spawnBlock(playerIndex) {
      const difficultySpeed = 2000; // m√™me vitesse pour les deux joueurs, ajustable
      createBlock(playerIndex);
      gameTimers[playerIndex] = setTimeout(() => {
        // Bloc non cliqu√©
        if (currentBlocks[playerIndex].isGray) {
          // Ignorer bloc gris si non cliqu√©
          spawnBlock(playerIndex);
          return;
        }
        lives[playerIndex]--;
        if (lives[playerIndex] <= 0) {
          endGame(playerIndex, 'a perdu toutes ses vies !');
          return;
        }
        updateUI();
        spawnBlock(playerIndex);
      }, difficultySpeed);
    }

    function updateUI() {
      for(let i=0; i<2; i++) {
        document.getElementById(`player${i+1}Area`).querySelector('h2').textContent =
          `Joueur ${i+1} ‚Äî ‚ù§Ô∏è ${lives[i]} ‚Äî üèÜ ${scores[i]}`;
      }
    }

    function startGame() {
      lives = [3, 3];
      scores = [0, 0];
      updateUI();
      spawnBlock(0);
      spawnBlock(1);
    }

    function endGame(playerIndex, message) {
      clearTimeout(gameTimers[0]);
      clearTimeout(gameTimers[1]);
      alert(`Fin du jeu ! Joueur ${playerIndex + 1} ${message}\n\nScores finaux:\nJoueur 1 : ${scores[0]} üèÜ\nJoueur 2 : ${scores[1]} üèÜ`);
      // Remet √† z√©ro
      document.getElementById('gameArea1').innerHTML = '';
      document.getElementById('gameArea2').innerHTML = '';
      for(let i=0; i<2; i++) {
        lives[i] = 3;
        scores[i] = 0;
      }
      updateUI();
    }

    // Quitter bouton reload page (ou tu peux adapter)
    document.getElementById('quitBtn').onclick = () => {
      clearTimeout(gameTimers[0]);
      clearTimeout(gameTimers[1]);
      location.reload();
    };

    // Lancer automatiquement le jeu local au chargement
    window.onload = () => {
      startGame();
    };

    // Ajuster taille blocs au resize
    window.addEventListener('resize', () => {
      // Si un bloc existe, repositionne avec la bonne taille
      for(let i=0; i<2; i++) {
        if(currentBlocks[i]) {
          const block = currentBlocks[i].element;
          const size = getBlockSize();
          block.style.width = size + 'px';
          block.style.height = size + 'px';
          const gameArea = document.getElementById(`gameArea${i + 1}`);
          block.style.top = Math.min(parseFloat(block.style.top), gameArea.clientHeight - size) + 'px';
          block.style.left = Math.min(parseFloat(block.style.left), gameArea.clientWidth - size) + 'px';
        }
      }
    });
  </script>
</body>
</html>















