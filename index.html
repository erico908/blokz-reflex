<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blokz Reflex</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; background: #111; color: #fff; }
    .page { display: none; padding: 20px; }
    .active { display: block; }
    #gameArea { position: relative; width: 100%; height: 80vh; background: #222; overflow: hidden; }
    .block {
      width: 60px; height: 60px; position: absolute; border-radius: 10px;
      cursor: pointer;
    }
    .red { background: red; }
    .blue { background: blue; }
    .green { background: green; }
    .yellow { background: yellow; }
    .gray { background: gray; }
    .hud { margin: 10px 0; }
    button { padding: 10px 20px; margin: 5px; }
  </style>
</head>
<body>

  <div id="home" class="page active">
    <h1>Blokz Reflex</h1>
    <p>Choisis une difficult√© :</p>
    <button onclick="chooseDifficulty('easy')">Facile</button>
    <button onclick="chooseDifficulty('medium')">Moyen</button>
    <button onclick="chooseDifficulty('impossible')">Impossible</button>
    <br><br>
    <button onclick="showPage('shop')">üè™ Boutique</button>
    <button onclick="showPage('profile')">üë§ Profil</button>
  </div>

  <div id="ready" class="page">
    <h2>Pr√™t ?</h2>
    <button onclick="startGame()">Commencer</button>
  </div>

  <div id="game" class="page">
    <div class="hud">
      Vies : <span id="lives">3</span> |
      Troph√©es : <span id="trophies">0</span> |
      Multiplicateur : <span id="multiplier">1</span> |
      Score : <span id="score">0</span>
    </div>
    <div id="countdown" style="font-size: 3em; text-align: center;"></div>
    <div id="gameArea"></div>
  </div>

  <div id="shop" class="page">
    <h2>Boutique</h2>
    <p>Multiplicateur actuel : x<span id="shopMultiplier">1</span></p>
    <p>Am√©liorer vers x<span id="nextMultiplier">2</span> pour <span id="multiplierCost">100</span> troph√©es</p>
    <button onclick="upgradeMultiplier()">üí™ Am√©liorer</button>
    <p>Ajouter 1 vie pour 50 troph√©es</p>
    <button onclick="buyLife()">‚ù§Ô∏è Acheter une vie</button>
    <br><br>
    <button onclick="showPage('home')">üè† Retour</button>
  </div>

  <div id="profile" class="page">
    <h2>Profil</h2>
    <p>Troph√©es : <span id="profileTrophies">0</span></p>
    <p>Vies : <span id="profileLives">3</span></p>
    <p>Multiplicateur : <span id="profileMultiplier">1</span></p>
    <br>
    <button onclick="showPage('home')">üè† Retour</button>
  </div>

  <script>
    const pages = ["home", "ready", "game", "shop", "profile"];
    const colors = ['red', 'blue', 'green', 'yellow'];
    const difficulties = { easy: 3000, medium: 1500, impossible: 800 };
    let gameTimer, currentBlock, selectedDifficulty = "easy";
    let trophies = parseInt(localStorage.getItem("trophies") || "0");
    let lives = parseInt(localStorage.getItem("lives") || "3");
    let multiplier = parseInt(localStorage.getItem("multiplier") || "1");
    let score = 0;

    function showPage(id) {
      pages.forEach(p => document.getElementById(p).classList.remove("active"));
      document.getElementById(id).classList.add("active");
      if (id === 'profile') updateProfile();
      if (id === 'shop') updateShop();
      if (id === 'game') updateHUD();
    }

    function chooseDifficulty(diff) {
      selectedDifficulty = diff;
      showPage('ready');
    }

    function startGame() {
      if (lives <= 0) {
        alert("Tu n'avais plus de vie, on t'en redonne 3 !");
        lives = 3;
        saveData();
      }
      score = 0;
      updateHUD();
      showPage('game');
      countdown(3, () => {
        spawnBlock();
      });
    }

    function countdown(seconds, callback) {
      const countdownEl = document.getElementById('countdown');
      countdownEl.textContent = seconds;
      let current = seconds;
      const interval = setInterval(() => {
        current--;
        if (current > 0) {
          countdownEl.textContent = current;
        } else {
          clearInterval(interval);
          countdownEl.textContent = "";
          callback();
        }
      }, 1000);
    }

    function spawnBlock() {
      if (lives <= 0) {
        endGame();
        return;
      }
      const gameArea = document.getElementById('gameArea');
      gameArea.innerHTML = "";
      const block = document.createElement('div');
      block.classList.add('block');

      const isGray = Math.random() < 0.15;
      if (isGray) {
        block.classList.add('gray');
        block.dataset.special = "trap";
      } else {
        const color = colors[Math.floor(Math.random() * colors.length)];
        block.classList.add(color);
        block.dataset.color = color;
      }

      const maxX = gameArea.clientWidth - 60;
      const maxY = gameArea.clientHeight - 60;
      block.style.left = Math.random() * maxX + 'px';
      block.style.top = Math.random() * maxY + 'px';

      block.addEventListener('click', () => {
        if (block.classList.contains('gray')) {
          alert("Tu as cliqu√© sur un bloc gris ! Partie termin√©e.");
          lives = 0;
          saveData();
          endGame();
          return;
        } else {
          score++;
          trophies += multiplier;
          updateHUD();
          saveData();
          clearTimeout(gameTimer);
          spawnBlock();
        }
      });

      gameArea.appendChild(block);

      gameTimer = setTimeout(() => {
        if (!block.classList.contains('gray')) {
          lives--;
          updateHUD();
          saveData();
          if (lives <= 0) {
            endGame();
            return;
          }
        }
        spawnBlock();
      }, difficulties[selectedDifficulty]);
    }

    function updateHUD() {
      document.getElementById('lives').textContent = lives;
      document.getElementById('trophies').textContent = trophies;
      document.getElementById('multiplier').textContent = multiplier;
      document.getElementById('score').textContent = score;
    }

    function endGame() {
      clearTimeout(gameTimer);
      alert(`Partie termin√©e !\nScore final : ${score}\nTroph√©es gagn√©s : ${score * multiplier}`);
      trophies += score * multiplier;
      saveData();
      showPage('home');
    }

    function updateShop() {
      document.getElementById('shopMultiplier').textContent = multiplier;
      document.getElementById('nextMultiplier').textContent = multiplier + 1;
      document.getElementById('multiplierCost').textContent = multiplier * 100;
    }

    function buyLife() {
      if (trophies >= 50) {
        trophies -= 50;
        lives++;
        saveData();
        updateShop();
        alert("Vie suppl√©mentaire achet√©e !");
      } else {
        alert("Pas assez de troph√©es !");
      }
    }

    function upgradeMultiplier() {
      const cost = multiplier * 100;
      if (trophies >= cost) {
        trophies -= cost;
        multiplier++;
        saveData();
        updateShop();
        alert("Multiplicateur am√©lior√© !");
      } else {
        alert("Pas assez de troph√©es !");
      }
    }

    function updateProfile() {
      document.getElementById('profileTrophies').textContent = trophies;
      document.getElementById('profileLives').textContent = lives;
      document.getElementById('profileMultiplier').textContent = multiplier;
    }

    function saveData() {
      localStorage.setItem("trophies", trophies);
      localStorage.setItem("lives", lives);
      localStorage.setItem("multiplier", multiplier);
    }

    window.onload = () => {
      if (isNaN(lives) || lives < 1) lives = 3;
      if (isNaN(trophies) || trophies < 0) trophies = 0;
      if (isNaN(multiplier) || multiplier < 1) multiplier = 1;
      saveData();
    }
  </script>

</body>
</html>


















